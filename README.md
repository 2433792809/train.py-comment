 训练脚本中的初始化代码注释
——————————————————————————————————————————
-------------------------------------------------------------------------------------------------------------------------------------------------------------
✔训练前应当做的初始化
---------------------------------------------------------------------------------------------------------------------------------------------------------
启动⼀个 Pytorch 训练⼯程之前，我们要配置好所有要⽤上的东⻄，除了数据集之外，我们还有什么是要初始化的呢？

答：


✔训练脚本中的初始化代码注释
---------------------------------------------------------------------------------------------------------------------------------------------------------
    self.device = torch.device('cuda:0' if args.is_cuda else'cpu') 

这段代码是在PyTorch中用于设置设备（device）的。如果args.is_cuda为True，则将设备设置为GPU；否则将设备设置为CPU。

torch.device函数用于创建一个PyTorch设备对象，接受一个字符串参数，表示设备名称。当参数为'cuda:0'时，表示使用第一个可用的GPU设备；当参数为'cpu'时，表示使用CPU设备。
因此，这段代码的作用是将设备设置为GPU（如果可用），否则设置为CPU，以便在训练或推理期间执行相应的计算。

---------------------------------------------------------------------------------------------------------------------------------------------------------
    'num_workers': args.num_workers

这段代码是在设置PyTorch数据加载器（DataLoader）的参数。其中，num_workers参数表示用于数据加载的子进程数量。在这段代码中，args.num_workers表示使用命令行参数args中指定的子进程数量来加载数据。因此，这段代码的作用是根据args参数中的num_workers值，设置数据加载器使用的子进程数量。

num_workers参数决定了数据加载器将会启动多少个子进程来预先加载数据，以提高训练效率。默认情况下，该参数值为0，即表示不使用子进程来加载数据。如果将该参数设置为一个正整数，那么数据加载器将会启动相应数量的子进程来加载数据。通常情况下，这个值可以根据机器的CPU核心数来设置。

---------------------------------------------------------------------------------------------------------------------------------------------------------
    train_dataset = datasets.ImageFolder(
    args.train_dir, # ?
    transform=transforms.Compose([
    transforms.RandomResizedCrop(256), # ?
    transforms.ToTensor() # ?
     ])
     )
 
 args.train_dir：表示训练数据集所在的目录路径。
 
 transforms.RandomResizedCrop(256): 是 PyTorch 中的一个图像预处理操作，用于将输入的图像随机裁剪为指定大小。具体来说，该函数会按照以下步骤进行处理：

从原始图像中随机选择一个矩形区域。

将该区域按照指定的大小（256x256）进行裁剪，并将其缩放为指定的大小.

返回裁剪并缩放后的图像。

transforms.ToTensor() :是将输入的图像转换为张量形式，以便可以被输入到 PyTorch 模型中进行训练或预测。

---------------------------------------------------------------------------------------------------------------------------------------------------------
    self.train_loader = DataLoader(
    dataset=train_dataset, # ?
    batch_size=args.batch_size, # ?
    shuffle=True, # ?
    **kwargs
     )
     
 dataset=train_dataset：是将训练数据集传递给数据加载器，以便批量加载训练数据。
 
 batch_size=args.batch_size：是将每个批次中包含的样本数传递给数据加载器，以便批量加载训练数据

shuffle=True 的作用是将训练数据集中的样本进行随机排序，以便在每个 epoch 中训练不同的样本，增强模型的泛化能力。

---------------------------------------------------------------------------------------------------------------------------------------------------------
  self.model = net.to(self.device) 

self.model = net.to(self.device) ：是将模型 net （表示神经网络模型）移动到指定的设备上，以便在训练过程中使用该设备进行计算。这里的 self.device 是在程序运行时根据用户是否启用 GPU 来选择的设备，如果用户启用了 GPU，则将模型移动到 GPU 上进行计算；否则，将模型移动到 CPU 上进行计算。

---------------------------------------------------------------------------------------------------------------------------------------------------------
  worker = Worker(args=args) 

worker = Worker(args=args) ：是创建一个 Worker 对象，并将参数 args 传递给该对象。在后续的程序中，可以通过调用 worker 对象的方法来实现模型的训练和评估。

✔拓展
-----------------------------------------------------------------------------------------------------------------------------------------
args 是一个命令行参数解析后得到的 Namespace 对象，其中包含了程序运行时用户设置的各种参数信息。在 Python 中，可以通过 argparse 模块来实现命令行参数解析。

具体来说，args 中包含了程序运行时用户设置的各种参数信息，比如训练数据的路径、测试数据的路径、学习率、批次大小等等。这些参数在程序运行时可以根据用户的设置而变化，从而实现不同的训练和评估过程。

因此，在程序中，args 的作用是保存了用户设置的各种参数信息，从而在程序的不同部分中可以方便地调用和使用这些参数。例如，在创建 Worker 对象时，需要将参数 args 传递给该对象，以便在训练和评估过程中使用这些参数。
